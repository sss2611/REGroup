{% extends 'base.html' %}

{% block title %}Registro - REGroup{% endblock %}

{% block content %}
<div class="form-container">
    <img src="../static/img/REGroup.jpg" alt="REGroup Logo" class="logo">
    <h2>Crea tu Cuenta</h2>
    <p>Únete a la red de reciclaje más grande.</p>
    <form method="POST" action="{{ url_for('auth.register') }}">
        {{ form.hidden_tag() }}
        
        <div class="form-group">
            {{ form.email.label }}
            {{ form.email(class="form-control", placeholder="ejemplo@correo.com") }}
            {% if form.email.errors %}
                <div class="error-message">
                    {% for error in form.email.errors %}<span>{{ error }}</span>{% endfor %}
                </div>
            {% endif %}
        </div>
        
        <div class="form-group">
            {{ form.password.label }}
            {{ form.password(class="form-control", placeholder="Mínimo 6 caracteres") }}
            {% if form.password.errors %}
                <div class="error-message">
                    {% for error in form.password.errors %}<span>{{ error }}</span>{% endfor %}
                </div>
            {% endif %}
        </div>

        <div class="form-group">
            {{ form.confirm_password.label }}
            {{ form.confirm_password(class="form-control", placeholder="Repite tu contraseña") }}
            {% if form.confirm_password.errors %}
                <div class="error-message">
                    {% for error in form.confirm_password.errors %}<span>{{ error }}</span>{% endfor %}
                </div>
            {% endif %}
        </div>

        <div class="form-group terms-group">
            {{ form.accept_tos() }}
            <label for="accept_tos" class="terms-label">
                Acepto los <a href="#" id="open-terms-modal">Términos y Condiciones</a>
            </label>
            {% if form.accept_tos.errors %}
                <div class="error-message">
                    {% for error in form.accept_tos.errors %}<span>{{ error }}</span>{% endfor %}
                </div>
            {% endif %}
        </div>
        
        <div class="form-group">
            {{ form.submit(class="btn") }}
        </div>
    </form>
<p class="switch-form">¿Ya tienes una cuenta? <a href="{{ url_for('auth.login') }}">Inicia sesión aquí</a></p></div>

<!-- Modal de Términos y Condiciones -->
<div id="terms-modal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
        <span class="modal-close-icon modal-close-btn">&times;</span>
        <div class="static-page-container">
            <!-- ============================================= -->
            <!-- AQUÍ ESTÁ EL CAMBIO -->
            <!-- ============================================= -->
            <h1>Términos y Condiciones de Uso de <img src="../static/img/logo.jpg" alt="REGroup Logo" class="h1-logo"></h1>
            <p class="last-updated">Última actualización: 29 de agosto de 2025</p>

            <div class="terms-content">
                <h2>1. Aceptación de los Términos</h2>
                <p>Al registrarse y utilizar la aplicación REGroup (en adelante, "la Aplicación"), usted acepta y se compromete a cumplir con los presentes Términos y Condiciones. Si no está de acuerdo con alguno de los términos, no debe utilizar la Aplicación.</p>
                <h2>2. Descripción del Servicio</h2>
                <p>REGroup es una plataforma que busca incentivar el reciclaje mediante un sistema de acumulación de puntos. Los usuarios pueden localizar "Puntos Verdes", registrar los materiales que reciclan y acumular puntos que podrán ser canjeados por beneficios y recompensas.</p>
                <!-- ... resto de los términos ... -->
            </div>
            
            <div class="modal-footer">
                <button class="btn modal-close-btn">Entendido</button>
            </div>
        </div>
    </div>
</div>

<script>
    // El script del modal no necesita cambios
    const modal = document.getElementById('terms-modal');
    const openBtn = document.getElementById('open-terms-modal');
    const closeBtns = document.querySelectorAll('.modal-close-btn');

    openBtn.addEventListener('click', function(event) {
        event.preventDefault();
        modal.style.display = 'flex';
    });

    closeBtns.forEach(btn => {
        btn.addEventListener('click', function() {
            modal.style.display = 'none';
        });
    });

    window.addEventListener('click', function(event) {
        if (event.target === modal) {
            modal.style.display = 'none';
        }
    });
</script>
{% endblock %}

