<!-- templates/dashboard.html -->
{% extends 'base.html' %}

{% block title %}Dashboard - REGroup{% endblock %}

{% block content %}
<div class="dashboard-container">
    <nav class="navbar">
        <img src="{{ url_for('static', filename='img/REGroup.jpg') }}" alt="REGroup Logo" class="nav-logo">
        <div class="user-info">
            <div class="points-display">
                <i class="fa-solid fa-gift"></i>
                <span><strong>{{ points }}</strong> Puntos</span>
            </div>
            <span>Hola, <strong>{{ username }}</strong></span>
            <a href="{{ url_for('logout') }}" class="btn btn-logout">Cerrar Sesión</a>
        </div>
    </nav>

    <div class="main-content">
        <!-- Tarjeta Principal de Acción -->
        <div class="card card-main-action">
            <i class="fa-solid fa-qrcode card-icon"></i>
            <div class="card-action-text">
                <h2>Escanea en el Punto REG para Sumar</h2>
                <p>Al llegar a un Punto REG, usa el escáner de la app para leer el código QR del lugar. Esto generará
                    una etiqueta única para tu entrega. Pégala en tu residuo y deposítalo. ¡Recibirás tus puntos tras la
                    verificación en planta!</p>
                    <i class="fa-solid fa-camera"></i>
                    <a href="{{ url_for('scan') }}" class="btn btn-scan"></a>
                    Escanear QR del Punto REG
                </a>
            </div>
        </div>

        <!-- Grid para las otras tarjetas -->
        <div class="dashboard-grid">

            <!-- Tarjeta de Actividad Reciente -->
            <div class="card">
                <div class="card-header">
                    <h3><i class="fa-solid fa-clock-rotate-left"></i> Actividad Reciente</h3>
                </div>
                <div class="card-body">
                    {% if recent_activity %}
                    <ul class="activity-list">
                        {% for activity in recent_activity %}
                        <li>
                            <i class="{{ activity.icon }} activity-icon"></i>
                            <span class="activity-item">{{ activity.item }}</span>
                            <span class="activity-points">+{{ activity.points }} pts</span>
                        </li>
                        {% endfor %}
                    </ul>
                    {% else %}
                    <p>Aún no tienes actividad registrada. ¡Registra tu primera entrega!</p>
                    {% endif %}
                </div>
            </div>

            <!-- Tarjeta de Recompensas -->
            <div class="card">
                <div class="card-header">
                    <h3><i class="fa-solid fa-trophy"></i> Recompensas Destacadas</h3>
                </div>
                <div class="card-body rewards-preview">
                    <p>¡Tu esfuerzo tiene premio! Canjea tus puntos por increíbles beneficios.</p>
                    <ul class="reward-examples">
                        <li><i class="fa-solid fa-ticket"></i> Entradas de cine</li>
                        <li><i class="fa-solid fa-tags"></i> Descuentos en tiendas</li>
                        <li><i class="fa-solid fa-seedling"></i> Donaciones a reforestación</li>
                    </ul>
                    <button class="btn btn-secondary" disabled>Ver todos los premios</button>
                </div>
            </div>

        </div>
    </div>
</div>

<!-- Mapa con puntos estratégicos -->
<div class="city-map">
    <h3><i class="fa-solid fa-map-location-dot"></i> Localiza tu PuntoREG más cercano </h3>
    <div class="map-container">
        <iframe
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3561.413314811062!2d-64.26416768495843!3d-27.79526498268259!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x943b5206f0c6c3b3%3A0x2f9b9c4f4f4f4f4f!2sSantiago%20del%20Estero%2C%20Argentina!5e0!3m2!1ses!2sar!4v1693412345678!5m2!1ses!2sar"
            width="100%" height="500" style="border:0;" allowfullscreen="" loading="lazy"
            referrerpolicy="no-referrer-when-downgrade"></iframe>

        <!-- Íconos simulados en ubicaciones clave -->
        <img src="{{ url_for('static', filename='img/tachy.png') }}" class="map-icon" style="top: 80px; left: 220px;" title="Municipalidad">
        <img src="{{ url_for('static', filename='img/tachy.png') }}" class="map-icon" style="top: 150px; left: 300px;" title="UNSE">
        <img src="{{ url_for('static', filename='img/tachy.png') }}" class="map-icon" style="top: 180px; left: 340px;" title="UCSE">
        <img src="{{ url_for('static', filename='img/tachy.png') }}" class="map-icon" style="top: 60px; left: 500px;" title="Aeropuerto">
        <img src="{{ url_for('static', filename='img/tachy.png') }}" class="map-icon" style="top: 100px; left: 250px;" title="Plaza Libertad">
        <img src="{{ url_for('static', filename='img/tachy.png') }}" class="map-icon" style="top: 130px; left: 270px;" title="Nodo Tecnológico">
        <img src="{{ url_for('static', filename='img/tachy.png') }}" class="map-icon" style="top: 160px; left: 200px;" title="Óvalo">
        <img src="{{ url_for('static', filename='img/tachy.png') }}" class="map-icon" style="top: 190px; left: 230px;" title="Domo del Centenario">
    </div>
</div>
{% endblock %}